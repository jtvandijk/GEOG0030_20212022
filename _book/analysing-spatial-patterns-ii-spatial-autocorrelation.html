<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation</title>
  <meta name="description" content="7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation handbook." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://jtvandijk.github.io/GEOG0030/" />
  
  <meta property="og:description" content="7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation handbook." />
  <meta name="github-repo" content="jtvandijk/GEOG0030" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation" />
  
  <meta name="twitter:description" content="7 Analysing Spatial Patterns II: Spatial Autocorrelation | GEOG0030: Geocomputation handbook." />
  

<meta name="author" content="Justin van Dijk" />


<meta name="date" content="2021-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"/>
<link rel="next" href="analysing-spatial-patterns-iii-point-pattern-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/custom.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo">
<a href="https://www.ucl.ac.uk/module-catalogue/modules/geocomputation-GEOG0030"><img src="images/general/ucl_logo.png">
</a></li>

<li class="divider"></li>
<li class="part"><span><b>Module overview</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Module Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#moodle"><i class="fa fa-check"></i>Moodle</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-overview"><i class="fa fa-check"></i>Module overview</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#troubleshooting"><i class="fa fa-check"></i>Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="part"><span><b>Foundational Concepts</b></span></li>
<li class="chapter" data-level="1" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html"><i class="fa fa-check"></i><b>1</b> Geocomputation: An Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#recording-w01"><i class="fa fa-check"></i><b>1.1</b> Lecture recording</a></li>
<li class="chapter" data-level="1.2" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#reading-w01"><i class="fa fa-check"></i><b>1.2</b> Reading list</a></li>
<li class="chapter" data-level="1.3" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#getting-started"><i class="fa fa-check"></i><b>1.3</b> Getting started</a></li>
<li class="chapter" data-level="1.4" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#software"><i class="fa fa-check"></i><b>1.4</b> Software</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#qgis-installation"><i class="fa fa-check"></i><b>1.4.1</b> QGIS Installation</a></li>
<li class="chapter" data-level="1.4.2" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#r-and-rstudio-installation"><i class="fa fa-check"></i><b>1.4.2</b> R and RStudio Installation</a></li>
<li class="chapter" data-level="1.4.3" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#ucl"><i class="fa fa-check"></i><b>1.4.3</b> UCL Desktop and RStudio Server</a></li>
<li class="chapter" data-level="1.4.4" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#a-note-on-arcgis"><i class="fa fa-check"></i><b>1.4.4</b> A note on ArcGIS</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#file-management"><i class="fa fa-check"></i><b>1.5</b> File management</a></li>
<li class="chapter" data-level="1.6" data-path="geocomputation-an-introduction.html"><a href="geocomputation-an-introduction.html#byl-w01"><i class="fa fa-check"></i><b>1.6</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html"><i class="fa fa-check"></i><b>2</b> GIScience and GIS software</a>
<ul>
<li class="chapter" data-level="2.1" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#recording-w02"><i class="fa fa-check"></i><b>2.1</b> Lecture recording</a></li>
<li class="chapter" data-level="2.2" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#reading-w02"><i class="fa fa-check"></i><b>2.2</b> Reading list</a></li>
<li class="chapter" data-level="2.3" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#simple-digitisation-of-spatial-features"><i class="fa fa-check"></i><b>2.3</b> Simple digitisation of spatial features</a></li>
<li class="chapter" data-level="2.4" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#population-change-in-london"><i class="fa fa-check"></i><b>2.4</b> Population change in London</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#setting-the-scene"><i class="fa fa-check"></i><b>2.4.1</b> Setting the scene</a></li>
<li class="chapter" data-level="2.4.2" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#w02-finding"><i class="fa fa-check"></i><b>2.4.2</b> Finding our data sets</a></li>
<li class="chapter" data-level="2.4.3" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#w02-downloading"><i class="fa fa-check"></i><b>2.4.3</b> Downloading and processing</a></li>
<li class="chapter" data-level="2.4.4" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#using-qgis-to-map-our-population-data"><i class="fa fa-check"></i><b>2.4.4</b> Using QGIS to map our population data</a></li>
<li class="chapter" data-level="2.4.5" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#exporting-map-for-visual-analysis"><i class="fa fa-check"></i><b>2.4.5</b> Exporting map for visual analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#assignment-w02"><i class="fa fa-check"></i><b>2.5</b> Assignment</a></li>
<li class="chapter" data-level="2.6" data-path="giscience-and-gis-software.html"><a href="giscience-and-gis-software.html#byl-w02"><i class="fa fa-check"></i><b>2.6</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html"><i class="fa fa-check"></i><b>3</b> Cartography and Visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#recording-w03"><i class="fa fa-check"></i><b>3.1</b> Lecture recording</a></li>
<li class="chapter" data-level="3.2" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#reading-w03"><i class="fa fa-check"></i><b>3.2</b> Reading list</a></li>
<li class="chapter" data-level="3.3" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#crime-in-london"><i class="fa fa-check"></i><b>3.3</b> Crime in London</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#w03-finding"><i class="fa fa-check"></i><b>3.3.1</b> Finding our data sets</a></li>
<li class="chapter" data-level="3.3.2" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#w03-downloading"><i class="fa fa-check"></i><b>3.3.2</b> Downloading and processing</a></li>
<li class="chapter" data-level="3.3.3" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#using-qgis-to-map-our-crime-data"><i class="fa fa-check"></i><b>3.3.3</b> Using QGIS to map our crime data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#assignment-w03"><i class="fa fa-check"></i><b>3.4</b> Assignment</a></li>
<li class="chapter" data-level="3.5" data-path="cartography-and-visualisation.html"><a href="cartography-and-visualisation.html#byl-w03"><i class="fa fa-check"></i><b>3.5</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html"><i class="fa fa-check"></i><b>4</b> Programming for Data Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#recording-w04"><i class="fa fa-check"></i><b>4.1</b> Lecture recording</a></li>
<li class="chapter" data-level="4.2" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#reading-w04"><i class="fa fa-check"></i><b>4.2</b> Reading list</a></li>
<li class="chapter" data-level="4.3" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#programming"><i class="fa fa-check"></i><b>4.3</b> Programming</a></li>
<li class="chapter" data-level="4.4" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#programming-in-r"><i class="fa fa-check"></i><b>4.4</b> Programming in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#the-rstudio-interface"><i class="fa fa-check"></i><b>4.4.1</b> The RStudio interface</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#rstudio-console"><i class="fa fa-check"></i><b>4.5</b> RStudio console</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#command-input"><i class="fa fa-check"></i><b>4.5.1</b> Command Input</a></li>
<li class="chapter" data-level="4.5.2" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#storing-variables"><i class="fa fa-check"></i><b>4.5.2</b> Storing variables</a></li>
<li class="chapter" data-level="4.5.3" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#accessing-and-returning-variables"><i class="fa fa-check"></i><b>4.5.3</b> Accessing and returning variables</a></li>
<li class="chapter" data-level="4.5.4" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#variables-of-different-data-types"><i class="fa fa-check"></i><b>4.5.4</b> Variables of different data types</a></li>
<li class="chapter" data-level="4.5.5" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#calling-functions-on-our-variables"><i class="fa fa-check"></i><b>4.5.5</b> Calling functions on our variables</a></li>
<li class="chapter" data-level="4.5.6" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#returning-functions"><i class="fa fa-check"></i><b>4.5.6</b> Returning functions</a></li>
<li class="chapter" data-level="4.5.7" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#examining-our-variables-using-functions"><i class="fa fa-check"></i><b>4.5.7</b> Examining our variables using functions</a></li>
<li class="chapter" data-level="4.5.8" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#creating-a-two-element-object"><i class="fa fa-check"></i><b>4.5.8</b> Creating a two-element object</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#simple-analysis"><i class="fa fa-check"></i><b>4.6</b> Simple analysis</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#housekeeping"><i class="fa fa-check"></i><b>4.6.1</b> Housekeeping</a></li>
<li class="chapter" data-level="4.6.2" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#atomic-vectors"><i class="fa fa-check"></i><b>4.6.2</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.6.3" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#matrices"><i class="fa fa-check"></i><b>4.6.3</b> Matrices</a></li>
<li class="chapter" data-level="4.6.4" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#dataframes"><i class="fa fa-check"></i><b>4.6.4</b> Dataframes</a></li>
<li class="chapter" data-level="4.6.5" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#column-names"><i class="fa fa-check"></i><b>4.6.5</b> Column names</a></li>
<li class="chapter" data-level="4.6.6" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#adding-columns"><i class="fa fa-check"></i><b>4.6.6</b> Adding columns</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#crime-analysis-i"><i class="fa fa-check"></i><b>4.7</b> Crime analysis I</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#starting-a-project"><i class="fa fa-check"></i><b>4.7.1</b> Starting a project</a></li>
<li class="chapter" data-level="4.7.2" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#setting-up-a-script"><i class="fa fa-check"></i><b>4.7.2</b> Setting up a script</a></li>
<li class="chapter" data-level="4.7.3" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#running-a-script"><i class="fa fa-check"></i><b>4.7.3</b> Running a script</a></li>
<li class="chapter" data-level="4.7.4" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#crime-data-2"><i class="fa fa-check"></i><b>4.7.4</b> Crime data</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#assignment-w04"><i class="fa fa-check"></i><b>4.8</b> Assignment</a></li>
<li class="chapter" data-level="4.9" data-path="programming-for-data-analysis.html"><a href="programming-for-data-analysis.html#byl-w04"><i class="fa fa-check"></i><b>4.9</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html"><i class="fa fa-check"></i><b>5</b> Programming for Spatial Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#recording-w05"><i class="fa fa-check"></i><b>5.1</b> Lecture recording</a></li>
<li class="chapter" data-level="5.2" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#reading-w05"><i class="fa fa-check"></i><b>5.2</b> Reading list</a></li>
<li class="chapter" data-level="5.3" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#crime-analysis-ii"><i class="fa fa-check"></i><b>5.3</b> Crime analysis II</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#data-preparation"><i class="fa fa-check"></i><b>5.3.1</b> Data preparation</a></li>
<li class="chapter" data-level="5.3.2" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#spatial-analysis-set-up"><i class="fa fa-check"></i><b>5.3.2</b> Spatial analysis set up</a></li>
<li class="chapter" data-level="5.3.3" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#interacting-with-spatial-data"><i class="fa fa-check"></i><b>5.3.3</b> Interacting with spatial data</a></li>
<li class="chapter" data-level="5.3.4" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#getting-our-crime-data-in-shape"><i class="fa fa-check"></i><b>5.3.4</b> Getting our crime data in shape</a></li>
<li class="chapter" data-level="5.3.5" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#data-wrangling"><i class="fa fa-check"></i><b>5.3.5</b> Data wrangling</a></li>
<li class="chapter" data-level="5.3.6" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#improving-your-workflow"><i class="fa fa-check"></i><b>5.3.6</b> Improving your workflow</a></li>
<li class="chapter" data-level="5.3.7" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#aggregate-crime-by-ward"><i class="fa fa-check"></i><b>5.3.7</b> Aggregate crime by ward</a></li>
<li class="chapter" data-level="5.3.8" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#joining-crime-data-to-wards"><i class="fa fa-check"></i><b>5.3.8</b> Joining crime data to wards</a></li>
<li class="chapter" data-level="5.3.9" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#mapping-crime-data"><i class="fa fa-check"></i><b>5.3.9</b> Mapping crime data</a></li>
<li class="chapter" data-level="5.3.10" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#styling-crime-data"><i class="fa fa-check"></i><b>5.3.10</b> Styling crime data</a></li>
<li class="chapter" data-level="5.3.11" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#exporting-our-crime-data"><i class="fa fa-check"></i><b>5.3.11</b> Exporting our crime data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#assignment-w05"><i class="fa fa-check"></i><b>5.4</b> Assignment</a></li>
<li class="chapter" data-level="5.5" data-path="programming-for-spatial-analysis.html"><a href="programming-for-spatial-analysis.html#byl-w05"><i class="fa fa-check"></i><b>5.5</b> Before you leave</a></li>
</ul></li>
<li class="part"><span><b>Core Spatial Analysis</b></span></li>
<li class="chapter" data-level="6" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><i class="fa fa-check"></i><b>6</b> Analysing Spatial Patterns I: Geometric Operations and Spatial Queries</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#recording-w06"><i class="fa fa-check"></i><b>6.1</b> Lecture recording</a></li>
<li class="chapter" data-level="6.2" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#reading-w06"><i class="fa fa-check"></i><b>6.2</b> Reading list</a></li>
<li class="chapter" data-level="6.3" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#bike-theft-in-london"><i class="fa fa-check"></i><b>6.3</b> Bike theft in London</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#housekeeping-w06"><i class="fa fa-check"></i><b>6.3.1</b> Housekeeping</a></li>
<li class="chapter" data-level="6.3.2" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#loading-data-w06"><i class="fa fa-check"></i><b>6.3.2</b> Loading data</a></li>
<li class="chapter" data-level="6.3.3" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#data-preparation-w06"><i class="fa fa-check"></i><b>6.3.3</b> Data preparation</a></li>
<li class="chapter" data-level="6.3.4" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#spatial-operations-i"><i class="fa fa-check"></i><b>6.3.4</b> Spatial operations I</a></li>
<li class="chapter" data-level="6.3.5" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#spatial-operations-ii"><i class="fa fa-check"></i><b>6.3.5</b> Spatial operations II</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#assignment-w06"><i class="fa fa-check"></i><b>6.4</b> Assignment</a></li>
<li class="chapter" data-level="6.5" data-path="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html"><a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html#byl-w06"><i class="fa fa-check"></i><b>6.5</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><i class="fa fa-check"></i><b>7</b> Analysing Spatial Patterns II: Spatial Autocorrelation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#recording-w07"><i class="fa fa-check"></i><b>7.1</b> Lecture recording</a></li>
<li class="chapter" data-level="7.2" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#reading-w07"><i class="fa fa-check"></i><b>7.2</b> Reading list</a></li>
<li class="chapter" data-level="7.3" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#childhood-obesity"><i class="fa fa-check"></i><b>7.3</b> Childhood obesity</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#housekeeping-w07"><i class="fa fa-check"></i><b>7.3.1</b> Housekeeping</a></li>
<li class="chapter" data-level="7.3.2" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#loading-data-w07"><i class="fa fa-check"></i><b>7.3.2</b> Loading data</a></li>
<li class="chapter" data-level="7.3.3" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#data-preparation-w07"><i class="fa fa-check"></i><b>7.3.3</b> Data preparation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#spatial-distributions"><i class="fa fa-check"></i><b>7.4</b> Spatial distributions</a></li>
<li class="chapter" data-level="7.5" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#assignment-w07"><i class="fa fa-check"></i><b>7.5</b> Assignment</a></li>
<li class="chapter" data-level="7.6" data-path="analysing-spatial-patterns-ii-spatial-autocorrelation.html"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#byl-w07"><i class="fa fa-check"></i><b>7.6</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="analysing-spatial-patterns-iii-point-pattern-analysis.html"><a href="analysing-spatial-patterns-iii-point-pattern-analysis.html"><i class="fa fa-check"></i><b>8</b> Analysing Spatial Patterns III: Point Pattern Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="analysing-spatial-patterns-iii-point-pattern-analysis.html"><a href="analysing-spatial-patterns-iii-point-pattern-analysis.html#recording-w08"><i class="fa fa-check"></i><b>8.1</b> Lecture recording</a></li>
<li class="chapter" data-level="8.2" data-path="analysing-spatial-patterns-iii-point-pattern-analysis.html"><a href="analysing-spatial-patterns-iii-point-pattern-analysis.html#reading-w08"><i class="fa fa-check"></i><b>8.2</b> Reading list</a></li>
<li class="chapter" data-level="8.3" data-path="analysing-spatial-patterns-iii-point-pattern-analysis.html"><a href="analysing-spatial-patterns-iii-point-pattern-analysis.html#assignment-w08"><i class="fa fa-check"></i><b>8.3</b> Assignment</a></li>
<li class="chapter" data-level="8.4" data-path="analysing-spatial-patterns-iii-point-pattern-analysis.html"><a href="analysing-spatial-patterns-iii-point-pattern-analysis.html#byl-w08"><i class="fa fa-check"></i><b>8.4</b> Before you leave</a></li>
</ul></li>
<li class="part"><span><b>Advanced Spatial Analysis</b></span></li>
<li class="chapter" data-level="9" data-path="rasters-zonal-statistics-and-interpolation.html"><a href="rasters-zonal-statistics-and-interpolation.html"><i class="fa fa-check"></i><b>9</b> Rasters, Zonal Statistics and Interpolation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="rasters-zonal-statistics-and-interpolation.html"><a href="rasters-zonal-statistics-and-interpolation.html#recording-w09"><i class="fa fa-check"></i><b>9.1</b> Lecture recording</a></li>
<li class="chapter" data-level="9.2" data-path="rasters-zonal-statistics-and-interpolation.html"><a href="rasters-zonal-statistics-and-interpolation.html#reading-w09"><i class="fa fa-check"></i><b>9.2</b> Reading list</a></li>
<li class="chapter" data-level="9.3" data-path="rasters-zonal-statistics-and-interpolation.html"><a href="rasters-zonal-statistics-and-interpolation.html#assignment-w09"><i class="fa fa-check"></i><b>9.3</b> Assignment</a></li>
<li class="chapter" data-level="9.4" data-path="rasters-zonal-statistics-and-interpolation.html"><a href="rasters-zonal-statistics-and-interpolation.html#byl-w09"><i class="fa fa-check"></i><b>9.4</b> Before you leave</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>10</b> Network Analysis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="network-analysis.html"><a href="network-analysis.html#recording-w10"><i class="fa fa-check"></i><b>10.1</b> Lecture recording</a></li>
<li class="chapter" data-level="10.2" data-path="network-analysis.html"><a href="network-analysis.html#reading-w10"><i class="fa fa-check"></i><b>10.2</b> Reading list</a></li>
<li class="chapter" data-level="10.3" data-path="network-analysis.html"><a href="network-analysis.html#assignment-w10"><i class="fa fa-check"></i><b>10.3</b> Assignment</a></li>
<li class="chapter" data-level="10.4" data-path="network-analysis.html"><a href="network-analysis.html#byl-w10"><i class="fa fa-check"></i><b>10.4</b> Before you leave</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GEOG0030: Geocomputation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analysing-spatial-patterns-ii-spatial-autocorrelation" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Analysing Spatial Patterns II: Spatial Autocorrelation</h1>
<p>This week, we will be looking at measuring spatial dependence. Spatial dependence is the idea that the observed value of a variable in one location is dependent (to some degree) on the observed value of the same value in a nearby location. For spatial analysis, this dependence can be assessed and measured statistically by considering the level of spatial autocorrelation between values of a specific variable, observed in either different locations or between pairs of variables observed at the same location. Spatial autocorrelation occurs when these values are not independent of one another and instead cluster together across geographic space.</p>
<div id="recording-w07" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Lecture recording</h2>
<ul>
<li>Lecture W7</li>
</ul>
</div>
<div id="reading-w07" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Reading list</h2>
<ul>
<li>Reading #1</li>
<li>Reading #2</li>
</ul>
</div>
<div id="childhood-obesity" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Childhood obesity</h2>
<p>This week, we are using a completely new data set and investigating a different phenomena: <strong>childhood obesity</strong>. We will be investigating its distribution across London at the ward-level. To complete this analysis, we will be using a single data download from the <a href="https://data.london.gov.uk/">London Datastore</a>, which we will need to clean, wrangle and then join to one of our ward shapefiles in order to spatially investigate the distribution of childhood obesity.</p>
<div id="housekeeping-w07" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Housekeeping</h3>
<p>Let’s get ourselves ready to start our lecture and practical content by first downloading the relevant data and loading this within our script.</p>
<p>Open a new script within your GEOG0030 project and save this script as <code>wk7-obesity-spatial-analysis.r</code>. At the top of your script, add the following metadata (substitute accordingly):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analysing childhood obesity and its factors</span></span>
<span id="cb1-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: January 2021</span></span>
<span id="cb1-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Justin </span></span></code></pre></div>
<p>This week we also need to install some additional libraries: <code>spdep</code>. <code>spdep</code> contains the relevant functions to run our various spatial autocorrelation tests. After installation, add the following libraries for loading in your script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb2-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb2-4"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb2-5"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb2-6"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb2-7"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code></pre></div>
</div>
<div id="loading-data-w07" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Loading data</h3>
<p>We are going to only need <strong>two</strong> data sets for this week - our London ward boundaries from 2011 and the Greater London Authority (GLA) Ward Atlas and Profiles. The GLA Ward Atlas and Profiles provide a range of demographic and related data for each ward in Greater London and were specifically designed to provide an overview of the ward’s population by collating and presenting a range of data on the population, diversity, households, life expectancy, housing, crime, benefits, land use, deprivation, and employment.</p>
<p>Indicators in the Atlas/Profile include:</p>
<ul>
<li>Age and sex</li>
<li>Land area, projections and population density</li>
<li>Household composition, religion, ethnicity</li>
<li>Birth rates (general fertility rate), death rates (standardised mortality ratio), life expectancy</li>
<li>Average house prices, properties sold, housing by council tax band, tenure, property size (bedrooms), dwelling build period and type, mortgage and landlord home repossession</li>
<li>Employment and economic activity, Incapacity Benefit, Housing Benefit, Household income, Income Support and JobSeekers Allowance claimant rates, dependent children receiving child-tax credits by lone parents and out-of-work families, child poverty</li>
<li>GCSE results, A-level / Level 3 results (average point scores), pupil absence,</li>
<li>Child obesity</li>
<li>Crime rates (by type of crime), fires, ambulance call outs, road casualties</li>
<li>Happiness and well-being, land use, public transport accessibility (PTALs), access to public greenspace, access to nature, air emissions / quality, car use, bicycle travel</li>
<li>Indices of Deprivation</li>
<li>Election turnout</li>
</ul>
<p>The main data set utilises the <strong>2011 Ward Boundaries as its spatial representation</strong>, therefore we need to use the 2011 boundaries. We already have our 2011 London Ward boundaries within our <code>raw</code> data folder, so we only need to download our Ward Atlas.</p>
<ol style="list-style-type: decimal">
<li>Navigate to the ward Atlas data set in the London Data Store: <a href="https://data.london.gov.uk/dataset/ward-profiles-and-atlas">[Link]</a>.</li>
<li>Download the <code>ward-atlas-data.csv</code>. You might find that instead of downloading the file, your browser will open up a new window. You have two options:
<ul>
<li>Copy and paste all contents of the page into a text editor such as Notepad and save your pasted contents as <code>ward-atlas-data.csv</code> in your <strong>raw</strong> data folder in a new <code>atlas</code> folder - make sure to add the <code>.csv</code> to the end of your file name to save your text file as a <code>csv</code>.</li>
<li>Click back to the data set page, right-click on the <code>ward-atlas-data.csv</code> name and select <strong>Download Linked File</strong> from your computer’s options. Move this into your <code>raw</code> data folder in a new <code>atlas</code> folder.</li>
</ul></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-1"></span>
<img src="images/w07/download_shot.gif" alt="Download linked file." width="450pt" />
<p class="caption">
Figure 7.1: Download linked file.
</p>
</div>
<p>Let’s first load our London ward shapefile from our <code>raw/boundaries/2011</code> folder:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in our London ward boundaries</span></span>
<span id="cb3-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb3-2" aria-hidden="true" tabindex="-1"></a>london_ward_shp <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;data/raw/boundaries/2011/London_Ward_CityMerged.shp&quot;</span>)</span></code></pre></div>
<p>We can both <code>View()</code> and <code>plot()</code> the data in our console to check what our data looks like. We are happy with the dataframe (its field names) and what its looking like as a shapefile, so we do not need to do any cleaning on this data set. We can now turn to our <strong>London Ward Atlas</strong> data set and load the <code>csv</code> data set into R:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in our ward atlas data csv from our raw data folder</span></span>
<span id="cb4-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb4-2" aria-hidden="true" tabindex="-1"></a>all_ward_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/raw/atlas/ward-atlas-data.csv&quot;</span>)</span></code></pre></div>
<p>If you go ahead and view the data, you will see we have a lot of information about our Wards in the data set - we have a total of <strong>946 variables</strong> four our 629 wards. We cannot exactly analyse all of these variables, so we will need to extract only the variables we need.</p>
<div class="note">
<p><strong>Note</strong> <br/>
If you run into an error along the lines of <code>Error in nchar(x, "width") : invalid multibyte string, element 1</code>, there is an issue with the character encoding of the file. If this is the case, please download a <a href="https://en.wikipedia.org/wiki/UTF-8#:~:text=UTF%2D8%20is%20a%20variable,Transformation%20Format%20%E2%80%93%208%2Dbit.&amp;text=Code%20points%20with%20lower%20numerical,are%20encoded%20using%20fewer%20bytes.">UTF-8 encoded</a> copy of the file here: <a href="https://github.com/jtvandijk/GEOG0030/tree/master/data/zip/ward-atlas-data.zip">[Link]</a></p>
</div>
</div>
<div id="data-preparation-w07" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Data preparation</h3>
<p>To clean our data and extract the variables for our analysis, we need to identify those most useful to our research. Of course, we need to find a variable that matches our phenomena of investigation: child obesity. We will also keep several additional variables in case one would want to move beyond studying the distribution of child obesity, e.g. by looking at explanatory factors such as:</p>
<ol style="list-style-type: decimal">
<li><strong>Individual level factors</strong>: diet and exercise, parents’ weights, mode of travel to school / time taken to walk to school.</li>
<li><strong>Household/societal level factors</strong>: area deprivation, household income, household employment</li>
</ol>
<p>This week, our data wrangling is quite minimal - but it is important you follow all the steps to ensure you have the correct final dataframe for our analysis. Overall, you will:</p>
<ul>
<li>Select the required columns for our dataframe and analysis.</li>
<li>Remove the first row which contains data that are part of the column names.</li>
<li>Remove the last three rows, which contains data for the whole of London, England, and England and Wales.</li>
<li>Clean and rename our field columns.</li>
<li>Coerce our variables into the correct data type for our analysis.</li>
<li>Join our ‘atlas data’ dataframe to our ward spatial dataframe.</li>
</ul>
<p>The fields that we need to extract from our data set include:</p>
<ul>
<li><strong>838</strong>: Childhood Obesity Prevalence; Year 6 (School children aged 10-11); 2011/12 to 2013/14: % obese</li>
<li><strong>900</strong>: Indices of Deprivation; IDACI; 2010</li>
<li><strong>248</strong>: House Prices; Median House Price; 2014</li>
<li><strong>353</strong>: Household Income; Mean Modelled Household income (£); 2012/13</li>
<li><strong>373</strong>: Employment; Adults not in Employment - 2011 Census; % of households with no adults in employment with dependent children</li>
<li><strong>377</strong>: Qualifications; Qualifications and Students - 2011 Census; % No qualifications</li>
<li><strong>859</strong>: Access to green space and nature; % homes with deficiency in access to nature; 2012</li>
<li><strong>865</strong>: Public Transport Accessibility; Average PTAL score; 2014</li>
</ul>
<p>and of course:</p>
<ul>
<li><strong>2</strong>: …2 - which contains our ward codes.</li>
<li><strong>4</strong>: …4 - which contains our ward names.</li>
</ul>
<p>Select our 10 fields from our <code>all_ward_data</code> dataframe for use in analysis:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select our 10 fields for analysis using their index number</span></span>
<span id="cb5-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb5-2" aria-hidden="true" tabindex="-1"></a>obesity_ward_data <span class="ot">&lt;-</span> <span class="fu">select</span>(all_ward_data, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">838</span>, <span class="dv">900</span>, <span class="dv">248</span>, <span class="dv">353</span>, <span class="dv">373</span>, <span class="dv">377</span>, <span class="dv">859</span>,</span>
<span id="cb5-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">865</span>)</span></code></pre></div>
<p>You should now have a new dataframe with our 10 variables. One issue with our original <code>csv</code> is that is contained two rows worth of field names - hence if you look at the first row of our dataframe, it does not make sense. We therefore want to remove this row as well as the last three rows. In addition, it would be good to clean up our names for use - here we’re going to use the <code>janitor</code> library, which cleans our names by removing white space, special characters, capitals etc.</p>
<p>Remove the first line of our dataframe and clean our field names:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove our first row, remove last three rows, clean the names of our fields</span></span>
<span id="cb6-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-2" aria-hidden="true" tabindex="-1"></a>obesity_ward_data <span class="ot">&lt;-</span> obesity_ward_data <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="sc">-</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">clean_names</span>()</span>
<span id="cb6-6"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb6-8"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(obesity_ward_data)</span></code></pre></div>
<pre><code>##  [1] &quot;x2&quot;                                                                                                                        
##  [2] &quot;x4&quot;                                                                                                                        
##  [3] &quot;childhood_obesity_prevalence_year_6_age_10_11_2011_12_to_2013_14_percent_obese&quot;                                            
##  [4] &quot;indices_of_deprivation_idaci_2010&quot;                                                                                         
##  [5] &quot;house_prices_median_house_price_2014&quot;                                                                                      
##  [6] &quot;household_income_mean_modelled_household_income_2012_13&quot;                                                                   
##  [7] &quot;employment_adults_not_in_employment_2011_census_percent_of_households_with_no_adults_in_employment_with_dependent_children&quot;
##  [8] &quot;qualifications_qualifications_and_students_2011_census_percent_no_qualifications&quot;                                          
##  [9] &quot;access_to_green_space_and_nature_percent_homes_with_deficiency_in_access_to_nature_2012&quot;                                   
## [10] &quot;public_transport_accessibility_average_ptal_score_2014&quot;</code></pre>
<p>The final thing we can do with this data set before we need to join it to our London Wards spatial dataframe is just tidy up our column names - <code>x2</code> and <code>x4</code> does not exactly mean much to us and it gives us a chance to shorten the names of the other variables; we could leave them as is now they have been cleaned, but it will be easier for reference later if they’re shorter.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename field names of ward data to something more useful</span></span>
<span id="cb8-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(obesity_ward_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ward_code&quot;</span>, <span class="st">&quot;ward_name&quot;</span>, <span class="st">&quot;y6_obesity_2014&quot;</span>, <span class="st">&quot;IDACI_2010&quot;</span>,</span>
<span id="cb8-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;med_house_price_2014&quot;</span>, <span class="st">&quot;mean_hh_income_2013&quot;</span>, <span class="st">&quot;per_no_adult_employ_2011&quot;</span>, <span class="st">&quot;per_no_qual_2011&quot;</span>,</span>
<span id="cb8-4"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;per_deficiency_greenspace_2012&quot;</span>, <span class="st">&quot;PTAL_2014&quot;</span>)</span></code></pre></div>
<p>Now we have the data we want to map, we need to do a final spot of checking - one of the main issues faced with loading data directly from a <code>csv</code> in R without cleaning it first in a spreadsheet programme as we have done before, is that we cannot guarantee that the data will be loaded correctly. Unfortunately with our current dataframe we can see that not all columns are correctly loaded - if you inspect the structure of the dataframe, you will see that several of our variables are of the type <code>char</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect the structure of the data</span></span>
<span id="cb9-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(obesity_ward_data)</span></code></pre></div>
<pre><code>## tibble [625 × 10] (S3: tbl_df/tbl/data.frame)
##  $ ward_code                     : chr [1:625] &quot;E09000001&quot; &quot;E05000026&quot; &quot;E05000027&quot; &quot;E05000028&quot; ...
##  $ ward_name                     : chr [1:625] &quot;City of London&quot; &quot;Abbey&quot; &quot;Alibon&quot; &quot;Becontree&quot; ...
##  $ y6_obesity_2014               : chr [1:625] &quot;23.21428571&quot; &quot;24.71655329&quot; &quot;25.99531616&quot; &quot;29.25851703&quot; ...
##  $ IDACI_2010                    : num [1:625] 0.12 0.439 0.397 0.38 0.435 ...
##  $ med_house_price_2014          : num [1:625] 765000 173000 215000 210000 240500 ...
##  $ mean_hh_income_2013           : chr [1:625] &quot;99390&quot; &quot;38870&quot; &quot;37290&quot; &quot;37860&quot; ...
##  $ per_no_adult_employ_2011      : chr [1:625] &quot;0.86659065&quot; &quot;8.748906387&quot; &quot;12.44019139&quot; &quot;10.73182137&quot; ...
##  $ per_no_qual_2011              : chr [1:625] &quot;6.7&quot; &quot;16.4&quot; &quot;31.2&quot; &quot;28&quot; ...
##  $ per_deficiency_greenspace_2012: chr [1:625] &quot;100&quot; &quot;2.164412071&quot; &quot;71.7273622&quot; &quot;17.1662713&quot; ...
##  $ PTAL_2014                     : chr [1:625] &quot;7.9&quot; &quot;5.989364918&quot; &quot;3.145890095&quot; &quot;2.8717665&quot; ...</code></pre>
<p>The results from the <code>str()</code> function suggest that some variables have been interpreted by R to be characters rather than numeric. This might be because there is some missing data or in some cases, the decimal point can interfere with the data being read as a numeric. Luckily it is easy to change our data type - a bit like right-clicking on our columns in Excel and setting the format of the column to <code>number</code>, we’ll do this using code. If we wanted to apply this to a single column than we would use the code: <code>as.numeric(dataframe$column)</code> but as we want to apply this across a few columns, we’ll be using the <code>mutate_at()</code> function from the <code>dplyr</code> library.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change data types</span></span>
<span id="cb11-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb11-2" aria-hidden="true" tabindex="-1"></a>obesity_ward_data <span class="ot">&lt;-</span> <span class="fu">mutate_at</span>(obesity_ward_data, <span class="fu">vars</span>(y6_obesity_2014, mean_hh_income_2013,</span>
<span id="cb11-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb11-3" aria-hidden="true" tabindex="-1"></a>    per_no_adult_employ_2011, per_no_qual_2011, per_deficiency_greenspace_2012, PTAL_2014),</span>
<span id="cb11-4"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">as.numeric</span>(x))</span></code></pre></div>
<pre><code>## Warning in (function (x) : NAs introduced by coercion</code></pre>
<p>You will see warnings that <code>NAs</code> have been introduced by this coercion in some of our variables - this is something we will need to be aware of later in our analysis, but will not look at right now. Now our final step is to join our final <code>obesity_ward_data</code> dataframe to our <code>london_wards_shp</code> spatial dataframe so we can complete both statistical and spatial analysis:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># join obesity df to ward sdf for analysis</span></span>
<span id="cb13-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb13-2" aria-hidden="true" tabindex="-1"></a>obesity_ward_sdf <span class="ot">&lt;-</span> <span class="fu">left_join</span>(london_ward_shp, obesity_ward_data,  </span>
<span id="cb13-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb13-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;GSS_CODE&quot;</span><span class="ot">=</span><span class="st">&quot;ward_code&quot;</span>))</span></code></pre></div>
<p>Have a look at your newly created spatial dataframe - for a quick look at the data, you can run the <code>plot()</code> command in <strong>your console</strong>. If you like, you can also write out the final <code>csv</code> using the <code>write_csv()</code> function to save a raw copy in your data folder.</p>
</div>
</div>
<div id="spatial-distributions" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Spatial distributions</h2>
<p>Today, we are interested in looking at spatial Autocorrelation: the effect of spatial processes on distributions. We will be using our newly created <code>obesity_ward_sdf</code> to look at this in action, whilst also answering questions on the overall distribution and factors of childhood obesity.</p>
<p>Within general data analysis, when it comes to analysing the distribution of your data, you are looking to conduct what is known as <strong>Exploratory Data Analysis</strong> (EDA) which is where we look to summarise the main characteristics of our data. EDA was promoted by prominent statistician <a href="https://en.wikipedia.org/wiki/John_Tukey">John Tukey</a> to encourage data analysts to explore their data outside of traditional formal modelling - and come up with new areas of investigation and hypotheses. Tukey promoted the use of five summary statistics: <strong>the max-min, the median, and the quartiles</strong>, which, in comparison to the mean and standard deviation, provide a more robust understanding of a data’s distribution, particularly if the data is skewed.</p>
<p>We looked at how we can use R to extract some of these summary statistics briefly in Week 4, but let’s have a look at how we can add further to this EDA, including creating some statistical charts of our data’s distribution.</p>
<p>In your script, below your joining of our dataframes, summarise our <code>y6_obesity_2014</code> distribution</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise our y6_obesity_2014 data</span></span>
<span id="cb14-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(obesity_ward_sdf<span class="sc">$</span>y6_obesity_2014)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
##   5.929  18.569  22.670  21.752  25.325  35.000      12</code></pre>
<p>This <code>summary()</code> function can also be called on the data set as a whole and will generate summary statistics for each individual numeric variable. You can execute this in your console if you like to get an understanding of all of variables - although we will focus on obesity for much of this practical. We can see that our <strong>Median</strong> and <strong>Mean</strong> are quite close to one another - and the quartiles are nearly the same amount apart from the mean, so we can start to think that our data is normally distribution. To confirm this, we can do the next best thing, which is plot our distribution using a <strong>histogram</strong>, using the base R <code>hist()</code> command:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the histogram of our y6_obesity_2014 data</span></span>
<span id="cb16-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(obesity_ward_sdf<span class="sc">$</span>y6_obesity_2014)</span></code></pre></div>
<p><img src="GEOG0030_files/figure-html/07-hist-1.png" width="672" /></p>
<p>We can actually see our data has a slight negative skew - which would make sense given that our median is higher than our mean.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="images/w07/distributions.png" alt="Cheatsheet on data distributions: negative skew, normal, positive skew." width="648" />
<p class="caption">
Figure 7.2: Cheatsheet on data distributions: negative skew, normal, positive skew.
</p>
</div>
<p>We can further customise our histograms if we want to make them more aesthetically pleasing and update the title and axis labeling:0</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pretty histogram</span></span>
<span id="cb17-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(obesity_ward_sdf<span class="sc">$</span>y6_obesity_2014, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Distribution of Obesity in Year 6 children, London Wards in 2014&quot;</span>,</span>
<span id="cb17-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Percentage of obese Year 6 children in the ward&quot;</span>)</span></code></pre></div>
<p><img src="GEOG0030_files/figure-html/07-hist-2-1.png" width="672" /></p>
<p>We can also export this histogram and save it as a <code>png</code> by a) storing the histogram code to a variable and b) saving this variable to a file. The code to do so is a little different - we essentially “open up” a file, called what we want to name our plot. We then run the code to plot our data, which will place the output “within” the file and then “close’ the file down.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open an empty png</span></span>
<span id="cb18-2"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="st">&quot;data/graphs/Y6_obesity_distribution.png&quot;</span>)</span>
<span id="cb18-3"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pretty histogram</span></span>
<span id="cb18-5"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(obesity_ward_sdf<span class="sc">$</span>y6_obesity_2014, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Distribution of Obesity in Year 6 children, London Wards in 2014&quot;</span>,</span>
<span id="cb18-6"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Percentage of obese Year 6 children in the ward&quot;</span>)</span>
<span id="cb18-7"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># close the png</span></span>
<span id="cb18-9"><a href="analysing-spatial-patterns-ii-spatial-autocorrelation.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p>You should now see the image appear in the folder that you specified (e.g. <code>data/graphs</code>).</p>
</div>
<div id="assignment-w07" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Assignment</h2>
</div>
<div id="byl-w07" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Before you leave</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="analysing-spatial-patterns-i-geometric-operations-and-spatial-queries.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analysing-spatial-patterns-iii-point-pattern-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtvandijk/GEOG0030/edit/master/07-autocorrelation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/jtvandijk/GEOG0030/raw/master/07-autocorrelation.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
